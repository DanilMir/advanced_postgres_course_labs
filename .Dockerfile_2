FROM ubuntu

RUN apt-get update

RUN apt install -y build-essential wget libreadline-dev zlib1g-dev flex bison libxml2-dev libxslt-dev libssl-dev libxml2-utils xsltproc libpq-dev
RUN apt install -y python3 python3-dev python3-setuptools python3-pip


RUN wget https://bootstrap.pypa.io/get-pip.py
RUN python3 get-pip.py
RUN rm get-pip.py


RUN wget https://ftp.postgresql.org/pub/source/v14.3/postgresql-14.3.tar.gz
RUN tar -xvf postgresql-14.3.tar.gz
RUN cd postgresql-14.3 && ./configure && make && make install


RUN set PATH=/usr/local/pgsql/bin:$PATH
RUN cd postgresql-14.3/contrib && wget https://github.com/pgsql-io/multicorn2/archive/refs/tags/v2.4.tar.gz
RUN cd postgresql-14.3/contrib && tar -xvf v2.4.tar.gz
RUN cd postgresql-14.3/contrib/multicorn2-2.4 && make
RUN cd postgresql-14.3/contrib/multicorn2-2.4 && make install



# RUN cd multicorn2-2.3 && make
# RUN cd multicorn2-2.3 && pip3 install .
